---
title: "Manuscript"
date: "`r format(Sys.time(), '%d %B, %Y')`"
author: 
  - Justin Pomeranz:
      email: jfpomeranz@gmail.com
      institute: cmu
      correspondence: true
  - name: James R. Junker
    institute: [glrc, lumcon]
  - name: Vojsava Gjoni
    institute: usd
  - name: Jeff S. Wesner
    institute: usd
institute:
  - cmu: Colorado Mesa University, Grand Junction, CO, USA
  - glrc: Great Lakes Research Center, Michigan Technological University, Houghton, MI USA
  - lumcon: Louisiana Universities Marine Consortium, Chauvin, LA USA
  - usd: Dept. of Biology, University of South Dakota, Vermillion, SD, USA
output:
   pdf_document:
     toc: yes
     keep_tex: true
     pandoc_args:
     - '--lua-filter=scholarly-metadata.lua'
     - '--lua-filter=author-info-blocks.lua'
   word_document:
      reference_docx: working_docx_template.docx
      toc: no
      pandoc_args:
      - '--lua-filter=scholarly-metadata.lua'
      - '--lua-filter=author-info-blocks.lua'
header-includes:
  - \usepackage{lineno}
  - \usepackage{amsmath}
  - \usepackage{indentfirst}
  - \linenumbers
  - \newcommand{\beginsupplement}{ \setcounter{table}{0} \renewcommand{\thetable}{S\arabic{table}} \setcounter{figure}{0} \renewcommand{\thefigure}{S\arabic{figure}}}
indent: true
linestretch: 1
bibliography: refs.bib
link-citations: no
link-color: grey
csl: ecology.csl
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE)
library(tidyverse)
```

**NOTE** I'm still working on integrating with Zotero and importing all the necessary references (thanks Jim for the help and instructions!). Don't worry about the **??** references in the rendered version for now. 

**Savina** I'm particularly keen to get your feedback on this. I think you mentioned including some other references and discussion in Jeff's Bayesian model paper. If you think they fit in here please let me know or feel free to include them. Likewise, please include any other comments you have, or if you have any insight into how the interpretation of results from different methods would vary. 

# Abstract

1.  Size spectra represent a fundamental attribute of community organization and are increasingly being used in assessments of fresh waters.
2.  Many methods have been proposed for constructing size spectra relationships, but recent work has shown that varied methods return biased estimates of relationship parameters, and different methods in fact are not estimating the same parameter. Despite this variability in estimates, it is unclear if the relative change across environmental gradients is consistent across methodologies. Here, we simulate data sets across an hypothetical environmental gradient and estimate the size spectra parameter (slope or exponent, depending on method) at each site, and, importantly, estimate the relationship of parameters across the hypothetical gradient. We also use two previously published body size datasets across an anthropogenic stress gradient and an environmental temperature gradient and assess how the conclusions of these studies would vary based on methods used.
3.  We find that maximum likelihood methods always perform as well or better than common binning methods. Additionally, the variance in estimates using MLE methods is markedly reduced when compared to binning methods.
4.  The uncertainty and variation in estimates when using binning methods is often greater than or equal to the variation previously published in experimental and observational studies, bringing into question the effect size of previously published results. However, re-analysis of two previously published datasets does not markedly alter the conclusions reached. Further study is needed to identify how and when these estimates may be biased, and when the general pattern of results can be considered to be "true".

# Introduction

Body size distributions are a fundamental characteristic of communities. The remarkable consistency of these relationships across spatiotemporal scales and habitat types has led them to be recommended as a "universal" indicator of ecological status (Petchey and Belgrano 2010)[@petchey2010]. Size metrics have commonly been used in marine systems, and are increasingly being applied to assess the condition of freshwater ecosystems (Martinez et al. 2016, Pomeranz 2018)[@martinez2016; @pomeranz2019].

Individual size distributions (ISD, also referred to as abundance size spectra) are commonly used. Generally, there is a negative relationship between body size (M) and abundance (N). Theoretical and empirical data support this relationship being described as a simple power law with exponent $\lambda$ in the form of $N \sim M^{\lambda}$. Commonly, $N$ is the count of body sizes grouped into bins, and $\lambda$ is estimated from OLS regressions of log transformed data of $N$ and the mid point of the body size bin $M_{bin}$: $\log(N_{count}) = \lambda \log(M_{bin})$. Myriad binning methods have been proposed, including linear and logarithmic bin widths. Likewise, methods can rely on the absolute count in the bins as well as normalization techniques where the count is divided by the bin width (especially common with logarithmic binning). Alternatively, $\lambda$ can be estimated directly using maximum likelihood techniques.

Previous work has shown that the estimates of $\lambda$ differ between MLE and OLS techniques. OLS methods are particularly sensitive to decisions made in the binning process. Simulation studies have shown that MLE offers consistently more accurate estimates of $\lambda$ (White et al. 2007, Edwards et al. 2017)[@white2007; @edwards2017], and reanalysis of empirical datasets also indicates that the conclusions are dependent on the methodology used (White et al. 2007, Edwards et al. 2020)[@white2007; @edwards2020]. However, recent empirical analysis of stream macroinvertebrate communities across the NAtional Ecological Observatory Network (NEON, USA) showed that while the estimates of $\lambda$ varied, the relative change across the environmental gradient was consistent regardless of method used (Pomeranz et al. 2022)[@pomeranz2022]. While there is a growing consensus that MLE methods offer more reliable estimates of $\lambda$, and binning methods result in biased estimates, it remains unclear if these biases are consistent and systematic or stochastic, and whether or not the relative change in ISD parameters is consistent across space and time. In other words, if the data within a study are all treated the same, does a relative change of OLS slope parameters of 0.1 coincide with a relative change of MLE estimates of 0.1? In order to answer this question, we simulate body size observations from bounded power law distributions with varied $\lambda$ exponents across a hypothetical environmental gradient and compare the results obtained using three different methodologies common in the literature. In addition, we re-analyze two previously published datasets of stream community body sizes across a stress and environmental gradient. We find that the MLE method more accurately estimates the site-specific $\lambda$ exponents as well as the relative change in exponents across the hypothetical gradient, as well as having smaller variation. The logarthmic binning methods generally perform well, but have larger confidence intervals around the estimates. However, the overall conclusions of previously published empirical data sets are not dependent on the method used.

# Methods

## Data Simulation

In order to investigate the performance of commonly used methods, we simulate body size observations from a bounded power law distribution using the inverse method, as described in Edwards et al. (2017)[-@edwards2017]. Let $M$ be a random variable of body sizes described by the probability density function:

$$f(M) = CM^\lambda, M_{min} \le M \le M_{max} $$

$M_{min} = 0.0026$ and $M_{max} = 1.2 *10^3$. These values are based on empirical body sizes of stream benthic communities reported in Pomeranz et al. (2020)[@pomeranz2022]. Our results are not dependent on the range of body sizes, and we show the results of other body size ranges in the supplemental information.

For the main analysis, presented here, we sampled $n = 1000$ body sizes from distributions described by five different $\lambda$'s: (-1.5, -1.75, -2.00, -2.25, -2.5), such that our model for $\lambda$ is:

$$\lambda = Norm(\alpha -0.5X, \sigma)$$

Each value of $\lambda$ was assumed to come from a community across a hypothetical environmental gradient $X$. Values of $X$ for each community are uniformly distributed from -1 to 1. We repeated the data simulation 1000 times (reps). The main results presented here were not dependent on the range of *x*-values or the number of sites (supplemental information).

### Sample size, $n$

The number of observations in our simulations may bias the results. Therefore, we repeated the simulations described above, but varied the sample size $n$. We tested values of $n = 200, 500, 1000, 5000, 10 000$.

### "No" relationship

It is possible that our sampling or simulation framework could bias the results obtained. In order to assess whether or not our simulations are robust to this, we performed independent random samples from a bounded power law for five communities across a hypothetical gradient as described above, but we set $\lambda = -2$ for all five communities. Hence, we are simulating a scenario where the size spectra relationship is invariant to our hypothetical environmental gradient, and we should expect the estimated relationship coefficient $\beta_1 = 0$.

## Finer resolution of $\lambda$ values

For the main analysis, we were interested in determining whether or not the methods were able to detect relatively coarse changes to size spectra parameters, specifically, a change of 0.5 units across each value of $X$, or an absolute change in $\lambda$ values of 1.0 units. However, many seminal works on variation in size spectra relationships in freshwater are on a much finer scale (on the order 0f 0.1 to 0.25 units). Therefore, we performed simulations as described above, but varied $\lambda$ from -1.9 to -2.1 across the hypothetical environmental gradient. This equates to a know relationship coefficient of $\beta_1 = 0.1$ across the hypothetical gradient, and an absolute change of 0.2 units.

## Estimation of Size spectra parameter $\lambda$

For each sample of $M$ and each of the 1000 replicates, we estimated the exponent $\lambda$ using MLE methods modified from the the `sizeSpectra` package (Edwards et al. 2020). In addition, we use two common binning methods to estimate the OLS slope parameter in log-log space. For the first binning method, we created 6 equal logarithmic bins covering the range of body sizes. The count in each bin was normalized by dividing by the bin width. This method has been used by (refs here, I think a lot of Woodward's group uses this...) Throughout the manuscript, the normalized equal logarithmic binning method will be referred to as ELBn. The second method was similar to ELBn, but bins of Log~2~ widths are used. The count in each bin is normalized in the same way. This method has been used by [@pomeranz2019; @mcgarvey2019] and is referred to as the Normalized Abundance Spectrum (NAS). Previous work has investigated the biases in $\lambda$ estimates when using different methods (Edwards et al. (2017)[-@edwards2017], Edwards et al. 2020[-@edwards2020], White et al. 2008[-@white2007]). The focus of the present work is to investigate biases when estimating the relationship or relative change in parameters across an environmental gradient. Hence, we do not discuss the $\lambda$ estimates in the main text, but the results are presented in the Supplemental Information (**NOTE** I'm thinking about dropping this from SI. Might be too much info, and it's already been published on by Edwards. Does this add anything to the story??).

## Estimation of relationship across gradient, $\beta_1$

For each simulation replicate, we estimated how the size spectra parameters varied across the hypothetical gradient. Simple OLS regression were conducted in the form $\lambda_{estimate} ~ \beta_0 + \beta_1 * X$. The distribution of the relationship coefficient, $\beta_1$, were plotted compared to the known relationship.

## Empirical Data

We re-analyze two data sets of benthic macroinvertebrate communities from stream habitats across two different gradients. In the first, quantitative macroinvertebrate samples were collected from streams across an acid mine drainage (AMD) stress gradient. Details of the sample collection and processing can be found in [@pomeranz2019]. Briefly, all individuals from each sample were identified to the lowest practical taxonomic unit and body lengths were measured using image processing software from photos taken with a camera mounted to a dissecting microscope. Body mass was estimated using taxon-specific published length weight regressions.

The second data set was from the wadeable stream sites of the National Ecological Observatory Network [@NEON_Inverts2022]. NEON stream sites are located across a wide temperature gradient in the United States, from Puerto Rico to Alaska. Quantitative macroinvertebrate samples were collected using the most appropriate method based on the local habitat. All individuals were identified and had their body lengths measured, and body mass was estimated using published length weight regressions. This data has been analyzed previously using size spectra methods as described in [@pomeranz2022]. Detailed methods of the sampling collection and data processing methods can be found on the NEON website ([<https://www.neonscience.org/data-collection/macroinvertebrates>], or macroinvertebrate DPI pubs). Coefficient estimates ($\pm$ 1 standard deviation) are compared across methods. This allows us to determine whether or not the main results would differ depending on the method used.

# Results

## Relationship across the hypothetical environmental gradient

![Relationship estimates across the hypothetical gradient for each replicate. Each panel is a different method for estimating the size spectra parameter.](figures/PLB_sim_main.png) 

Alternate plot version 

![alternate plot version, thoughts on which you prefer??](figures/PLB_main_v2.png)

All methods performed reasonably well in detecting the known relationship across the hypothetical environmental gradient (mean $\beta_1$ estimates ranged from -0.419 to -0.498). However, the SD for the NAS and ELBn methods were 2-3x larger that that of the MLE method (Figure ~XX~). This result was consistent across simulation parameters, including sample size, number of sites, and $\lambda$ values.

\newpage

![Halfeye plots for the estimated relationship coefficient estimates across 1000 replicates and three different methods. The point below each distribution plot is the median estimate, the thick and thin bars represent the 66th and 95th percentile, respectively. Vertical line is the known relationship. The median estimate for the MLE method was closest to the known relationship, and had the narrowest distribution across replicates.](figures/PLB_sim_relationship_density.png)

\newpage

```{r, echo=FALSE, warning=FALSE}
read.csv("results/PLB_sim.csv") %>%
  mutate(Model = name) %>%
  select(Model, p50, p25, p975) %>%
  mutate_at(vars(-Model), funs(round(., 2))) %>%
  arrange(p50, p975)
```

![Individual regression estimates across the hypothetical gradient based on sample size (rows) and methodology used (columns).](figures/n_vary_main.png)

\newpage

## No relationship

All of the methods performed similarly when there was no relationship across the hypothetical gradient. The mean $\beta_1$ estimates for all three methods ranged from -0.0005 to 0.0002. However, the distribution of coefficient estimates was much wider for the two binning methods; the 95th percentile of the MLE distributions is narrower thatn the 66th percentiles for the NAS and ELBn methods.

![Individual regression estimates when no relationship exists across the hypothetical environmental gradient. The methods are separated by rows. The median for all methocs is approximately zero, but the distribution for the MLE method is narrower than the two binning methods.](figures/PLB_static_b_relationship_density.png)

```{r, echo=FALSE, warning=FALSE}
read.csv("results/PLB_static_b.csv") %>%
  mutate(Model = name) %>%
  select(Model, p50, p25, p975) %>%
  mutate_at(vars(-Model), funs(round(., 2))) %>%
  arrange(p50, p975)
```

## Small variation in lambda

The performance of all methods to detect small variation in the $\lambda$ parameter (between -1.9 to -2.1) across the environmental gradient was also investigated. The median $\beta_1$ coefficient estimates for the MLE method was -0.1, which exactly matched the value for the hypothetical relationship, while the other two methods both had median estimates of 0.9. The upper 97.5 percentile of the distribution was below 0 for the MLE method, meaning that most of the estimates had the correct sign. In contrast, the upper 97.5 percentile for both the NAS and ELBn methods were greater than 0 at 0.027 and 0.052, respectively. (Figure 4).

![Distribution of the estimated relationship for each method. Here, $\lambda$ varied from -1.9 to -2.1, with a known relationaship of -0.1 across the gradient indicated by the dashed vertical line. The distribution of relationship estimates was approximately centered at the known relationship for all methods, with a narrower distribution observed for the MLE estimates.](figures/PLB_sim_small_relationship_density.png)

```{r, echo=FALSE, warning=FALSE}
read.csv("results/PLB_sim_small.csv") %>%
  mutate(Model = name) %>%
  select(Model, p50, p25, p975) %>%
  mutate_at(vars(-Model), funs(round(., 2))) %>%
  arrange(p50, p975)
```

## Empirical data

For both empirical data sets, the direction and magnitude of change (i.e. $\beta_1$ coefficients) are generally in agreement. Size spectra parameters consistently increase (become flatter) in the AMD data (Fig. XX A). Likewise, the size spectra parameters consistently increase (become steeper) with increasing temperature across the NEON sites (Fig XX D)

**NOTE** I need to re-plot these in ggplot and and stitich together. Currently stitching pre-made png files, I think that's why it looks so funky.

\newpage

![Figure of empirical data estimates. All of the methods estimate the same sign of the relationship, but the estimates from the binning methods are generally greater than the MLE estimates.](figures/empirical_combined.png)

\newpage

The $\beta_1$ coefficient estimates for the AMD data are all positive and of relatively similar magnitudes across methods. The MLE estimate has the smallest magnitude and SD (0.063 $\pm$ 0.011 SD), The ELBn method is slightly larger and has a wider SD : (0.072 $\pm$ 0.018). Finally, the NAS method has the largest estimate and an intermediate standard deviation (0.076 $\pm$ 0.013). The range of the gradient in the AMD data is relatively small (9.5), meaning that the absolute change in the size spectra parameter ($\lambda$) across the AMD gradient are similar regardless of method used (range of absolute: 0.59 to 0.72).

Similar to the AMD results, the $\beta_1$ coefficient estimates for the NEON data are all negative and have similar magnitudes across methods. The MLE estimate is once again the smallest (-0.006 $\pm$ 0.001 SD). The NAS and ELBn methods are larger at -0.004 $\pm$ 0.002, and -0.002 $\pm$ 0.002, respectively. Although the estimates are similar and have a small magnitude, the range of the gradient in this data is larger (\~30$\circ$C), meaning that the absolute change in $\lambda$ estimates ranges from 0.06 to 0.17, depending on the method used.

## Simulating shallower lambdas

Estimates of the relationship between lambda and a hypothetical gradient varied depending on the method used. However, interpretations of empirical data were broadly consistent across methodologies. Upon closer inspection, the values of size spectra parameters in the empirical data were considerably shallower than -2. Given that we found the performance of all methods increased with shallower $\lambda$'s we wanted to investigate how the methods performed with simulated values closer to the empirical estimates of parameters describing size spectra relationships. Therefore, we repeated the simulation process as in the main analysis, but used $\lambda$ values ranging from -1.1 to -1.5, with a known relationship of $\beta_1 = -0.2$

\newpage

![Relationship estimates across the hypothetical gradient for each replicate. Each panel is a different method for estimating the size spectra parameter.](figures/shallow_lambda_main.png)

We found generally less variability in the relationship estimates ($\beta_1$) across a gradient of distributions described with shallower $\lambda$ parameters. However, the median MLE estimate was once again closest to the hypothetical relationship and had the narrowest distribution. The median ELBn estimate was close to the hypothetical relationship but had a slightly wider distribution. Finally, 95% of the NAS estimates were greater than the hypothetical relationship. In general, the distributions from the different methodologies followed the same overall pattern, with the MLE estimates being the smallest, and the binning methods being larger (i.e., more positive).

![Distribution of relationship coefficient estimates. Vertical line is the known relationship. All methods under estimate the value, but the mean magnitude and distribution of values is greater for the ELBn and NAS methods.](figures/PLB_shallow_lambda_relationship_density.png)

```{r, echo=FALSE, warning=FALSE}
read.csv("results/shallow_lambda.csv") %>%
  mutate(Model = name) %>%
  select(Model, p50, p25, p975) %>%
  mutate_at(vars(-Model), funs(round(., 2))) %>%
  arrange(p50, p975)
```

\newpage

# Discussion

Measuring parameters describing the decline in abundance with increasing body size in communities is being done with increasing frequency across ecology. Previous work has investigated the accuracy and inherent biases associated with different estimation methods. However, how these inaccuracies and biases compound across environmental gradients remains uncertain, making it difficult to detect variation in size spectra parameters across environmental gradients with confidence. Here, we sampled body sizes from known distributions with varying parameters ($\lambda$) and estimated the coefficient of the relationship ($\beta_1$) across a hypothetical gradient in order to assess how the results would vary depnding on the method used. Likewise, we compared how the interpretation of previously published results could change depending on the methodology used to estimate the relationship.

Generally, the estimate from the MLE method was always closer to the known relationship in simulated data, and always had the smallest variation around the estimate.

Binning methods are easy to use and interpret, which most likely accounts for their wide use in ecological studies. However, aggregating individuals into logarithmic bins removes a large source of the variation within the data by collapsing body size variation into a single values within bins. For example, all individuals placed into a bin that ranges from 2-4 grams of mass are all treated as having a mass of 3 grams, the midpoint of that bin. Likewise, a single abundance value is taken for this bin, despite that fact that there is almost certainly variation in the abundance of individuals that weigh \~2 grams or \~4 grams. By homogenizing the data in this way, it seems that binning methods will always produce noisier results than MLE from the binning process alone, since binning is akin to deleting information that the model could otherwise use.

One of the benefits of using MLE is that all data points are retained for use within the model.

The performance of all methods improved as sample size increases, and as the exponent of the size spectra relationship gets larger (more shallow). As either or both of these variables change, the difference in estimated relationship coefficients declines across the methods. This is particularly interesting given the fact that both empirical data sets of stream communities examined here are shallower than the expected relationship of $\lambda = -2$, and the conclusions of the change in size spectra relationships across the gradients are not dependent on method used. If communities under study are in fact described by shallower exponents, the method used may not be critical in the conclusions reached. However, the MLE method performs as well or better than the two binning methods examined here under all contexts and should be the preferred method in future studies. At a minimum, future studies should report MLE estimates to ensure that the results are not dependent on the methodology used.

Despite the drop in performance with reduced variation in $\lambda$ values, when a significant relationship was observed, it was generally in the correct direction and of a similar magnitude. This suggests that previously reported significant changes in size spectra parameters across environmental gradients and in experimental manipulations are plausible, and the magnitude of the relative change is a reasonable estimate. Given that all of the data within a study is treated identically, the the over all change in size spectra parameters is likely reasonable. However, the biases and inconsistencies in relationship estimates presented here suggest that it would be difficult if not impossible to compare the relative changes across different published studies which use different methods. Publication of individual body size data with future studies of size spectra relationships would greatly aid in our ability to generalize changes to this fundamental aspect of community organization across spatiotemporal scales and in response to environmental stressors and perturbations.

## Concluding Remarks

Both of the binning methods can perform as well as MLE under certain circumstances (large sample size, shallow $\lambda$). However, it would be extremely difficult to know if this was the case beforehand. Furthermore, in order to confirm this result, MLE methods would likely need to be employed. With the publication of the sizespectra package [-@edwards2017], producing MLE estimates of size spectra parameters is a relatively easy task. Therefore, we recommend using this in all future studies of size spectra relationships.

We reiterate the recommendations of White et al. (2007)[-@white2007], Sprules and Barth (2016)[-@sprules2016] and Edwards et al. (2017)[-@edwards2017] to estimate size spectra relationships using MLE methods due to their superior performance in nearly every context. Furthermore, we strongly encourage authors to publish individual size data whenever possible. This will allow for the consistent re-analysis of existing data sets as methodologies develop and improve. This will aid in the ability for size spectra work to be synthesized between research groups and across scales.

\newpage

# References

::: {#refs}
:::

\newpage

# Supplementary material {.unnumbered}

```{=tex}
\beginsupplement
```
## Range of body sizes, $M$

![Individual regressions for five sites across a hypothetical gradient with a known relationship of 0.5. Range of body sizes is reduced and is from 1, to 100.](figures/PLB_small_m_main.png)

\newpage

![Distribution of estimated relationship ($\beta_1$) coefficient's for five sites across a hypothetical gradient with known value of 0.5. Range of body sizes is reduced and is from 1, to 100.](figures/PLB_small_m_relationship_density.png)

\newpage

## Large environmental gradient

![Individual regressions for five sites across a hypothetical gradient with a known relationship of 0.5. Range of environmental values (*x*-axis) increased to be -1000, to 1000.](figures/PLB_large_x_main.png)

\newpage

![Distribution of estimated $\lambda$ coefficient for five sites across a hypothetical gradient with known values. Range of environmental values (*x*-axis) increased to be -1000, to 1000.](figures/PLB_large_x_est_b_density.png)

\newpage

![Distribution of estimated relationship ($\beta_1$) coefficient's for five sites across a hypothetical gradient with known value of 0.5. Range of environmental values (*x*-axis) increased to be -1000, to 1000.](figures/PLB_large_x_relationship_density.png)

\newpage

## Varying number of sites

### 10 sites

![Individual regressions for ten sites across a hypothetical gradient with a known relationship of 0.5. All other parameters are the same as in the main analysis](figures/PLB_10_sites_main.png)

\newpage

![Distribution of estimated $\lambda$ coefficient for ten sites across a hypothetical gradient with known values. All other parameters are the same as in the main analysis](figures/PLB_10_sites_est_b_density.png)

\newpage

![Distribution of estimated relationship ($\beta_1$) coefficient's for ten sites across a hypothetical gradient with known value of 0.5. All other parameters are the same as in the main analysis](figures/PLB_10_sites_relationship_density.png)

\newpage

### Three sites

![Individual regressions for three sites across a hypothetical gradient with a known relationship of 0.5. All other parameters are the same as in the main analysis.](figures/PLB_3_sites_main.png)

\newpage

![Distribution of estimated $\lambda$ coefficient for three sites across a hypothetical gradient with known values. All other parameters are the same as in the main analysis.](figures/PLB_3_sites_est_b_density.png)

\newpage

![Distribution of estimated relationship ($\beta_1$) coefficient's for three sites across a hypothetical gradient with known value of 0.5. All other parameters are the same as in the main analysis](figures/PLB_3_sites_relationship_density.png)

\newpage

## Sample size

![Distribution of size spectra parameter estimates. Vertical line is the known parameter (dashed line) wich describes the bounded power law distribution from which the body size estimates were sampled. As n increases (top to bottom) and $\lambda$ increases (left to right), the accuracy of the estimate improves across all methods.](figures/n_vary_est_b.png)

\newpage

![Individual regressions when varying sample size](figures/n_vary_main.png)

\newpage

![Distribtuion of the relationship coefficients with varying sample size](figures/n_vary_relationship_density.png)

\newpage

## $\lambda$ and relationship estimates

**NOTE** I'm considering dropping the $\lambda$ estimate plots from the manuscript. I think it's too much info, but if it adds to the story I'm happy to leave it in. **END**

In the main analysis, we simulate body size data from bounded power law distributions while varying the $\lambda$ exponent which describes the distribution. For the results presented in the main text, we held the number of sites at 5, scaled the environmental gradient from -1 to 1, and set the minimum and maximum body sizes to $0.0026$ and $1.2 *10^3$ respectively. Here, we plot the results of varying the number of sites (3, 10), increasing the scale of the environmental gradient (-100 to 100) and decreasing the range of body sizes (min = 1, max = 100). Generally, the results reported in the main manuscript are robust to changing these parameters: the MLE estimate is nearly always closer to the known parameters, and the variation in these estimates is usually smaller than the binning methods.

\newpage

### Number of sites = 3

![Distribution of estimated $\lambda$ coefficient across a hypothetical gradient with known values (dashed line). The number of sites is reduced to 3, compared with 5 sites presented in the main anaysis.](figures/PLB_3_sites_est_b_density.png)

\newpage

![Relationship estimate](figures/PLB_3_sites_relationship_density.png)

\newpage

### Number of sites = 10

![Distribution of estimated $\lambda$ coefficient across a hypothetical gradient with known values(dashed line). The number of sites is increased to 10, compared with 5 sites presented in the main anaysis.](figures/PLB_10_sites_est_b_density.png)

\newpage

![Relationship estimate](figures/PLB_10_sites_relationship_density.png)

\newpage

### Environmental Gradient

![Distribution of estimated $\lambda$ coefficient for five sites across a hypothetical gradient with known values (dashed line). The range of the environmental gradient was increased (-100 to 100).](figures/PLB_large_x_est_b_density.png)

\newpage

![Relationship estimate](figures/PLB_large_x_relationship_density.png)

\newpage

### Range of body sizes = 1 to 100

![Distribution of estimated \$\\lambda\$ coefficient for five sites across a hypothetical gradient with known values(dashed line). Range of body sizes is smaller than main anaysis and ranges from 1, to 100.](figures/PLB_small_m_est_b_density.png)

\newpage

![Relationship estimate](figures/PLB_small_m_relationship_density.png)
